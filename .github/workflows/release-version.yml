name: release-api-version
on:
  push:
    branches:
      - multi_tenant_dev
      - multi_tenant_stage

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - name: Echo Branch name
        run: |
          branch_name="${GITHUB_REF#refs/heads/}"
          echo $branch_name

      - name: run reporting release version workflow
        uses: codex-/return-dispatch@v1
        id: return_dispatch
        with:
          token: ${{ secrets.GH_TOKEN }}
          ref: ${{ github.event.workflow_run.head_branch }}
          repo: workflow-target
          owner: prashant-cloudbolt
          workflow: release-version.yml

      - name: Watch reporting release version workflow
        continue-on-error: true
        env:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
        run: |
          RUN_ID=${{steps.return_dispatch.outputs.run_id}}
          gh run watch $RUN_ID --repo prashant-cloudbolt/workflow-target